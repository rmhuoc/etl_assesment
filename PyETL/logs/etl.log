2025-06-17 01:51:09,763:INFO:Starting ETL process...
2025-06-17 01:51:09,808:INFO:ETL process started with process_id=261
2025-06-17 01:51:09,911:INFO:Generated mock data saved to data/sales_transactions_261.csv with 10000 rows.
2025-06-17 01:51:09,981:INFO:Encryption key successfully loaded from 'config/secret.key'
2025-06-17 01:51:10,215:INFO:Encrypted CSV written to 'data/sales_transactions_261_encrypted.csv'
2025-06-17 01:51:10,221:INFO:Connection to database OK and verified.
2025-06-17 01:51:10,233:INFO:Processing file data/sales_transactions_261_encrypted.csv into etl_assesment_data.sales_tmp using chunks of size 2000
2025-06-17 01:51:10,233:INFO:Reading file data/sales_transactions_261_encrypted.csv in chunks of 2000 with max_workers=4
2025-06-17 01:51:10,233:INFO:=== ETL Configuration ===
2025-06-17 01:51:10,233:INFO:File path: data/sales_transactions_261_encrypted.csv
2025-06-17 01:51:10,233:INFO:Chunk size: 2000
2025-06-17 01:51:10,233:INFO:Max workers: 4
2025-06-17 01:51:10,233:INFO:Target schema: etl_assesment_data
2025-06-17 01:51:10,233:INFO:Target table: sales_tmp
2025-06-17 01:51:10,233:INFO:==========================
2025-06-17 01:51:10,311:INFO:Column 'process_id' is missing in DataFrame. Skipping adding it with None values here.
2025-06-17 01:51:10,343:INFO:[Chunk-0] STARTED with 2000 rows
2025-06-17 01:51:10,353:INFO:[Chunk-1] STARTED with 2000 rows
2025-06-17 01:51:10,362:INFO:[Chunk-2] STARTED with 2000 rows
2025-06-17 01:51:10,371:INFO:[Chunk-3] STARTED with 2000 rows
2025-06-17 01:51:12,350:INFO:[Chunk-0] Removed 1 rows with timestamp in the future
2025-06-17 01:51:12,383:INFO:[Chunk-1] Removed 3 rows with timestamp in the future
2025-06-17 01:51:12,389:INFO:[Chunk-3] Removed 5 rows with timestamp in the future
2025-06-17 01:51:12,395:INFO:[Chunk-2] Removed 1 rows with timestamp in the future
2025-06-17 01:51:12,397:INFO:Added process_id=261 to DataFrame before load.
2025-06-17 01:51:12,450:INFO:Added process_id=261 to DataFrame before load.
2025-06-17 01:51:12,487:INFO:Added process_id=261 to DataFrame before load.
2025-06-17 01:51:12,504:INFO:Added process_id=261 to DataFrame before load.
2025-06-17 01:51:12,566:INFO:Loaded 1999 records into etl_assesment_data.sales_tmp using COPY (process_id=261)
2025-06-17 01:51:12,567:INFO:[Chunk-0] FINISHED loading 1999 records
2025-06-17 01:51:12,567:INFO:[Chunk-4] STARTED with 2000 rows
2025-06-17 01:51:12,570:INFO:Loaded 1997 records into etl_assesment_data.sales_tmp using COPY (process_id=261)
2025-06-17 01:51:12,570:INFO:[Chunk-1] FINISHED loading 1997 records
2025-06-17 01:51:12,585:INFO:Loaded 1995 records into etl_assesment_data.sales_tmp using COPY (process_id=261)
2025-06-17 01:51:12,585:INFO:[Chunk-3] FINISHED loading 1995 records
2025-06-17 01:51:12,597:INFO:Loaded 1999 records into etl_assesment_data.sales_tmp using COPY (process_id=261)
2025-06-17 01:51:12,597:INFO:[Chunk-2] FINISHED loading 1999 records
2025-06-17 01:51:14,575:INFO:[Chunk-4] Removed 6 rows with timestamp in the future
2025-06-17 01:51:14,586:INFO:Added process_id=261 to DataFrame before load.
2025-06-17 01:51:14,667:INFO:Loaded 1994 records into etl_assesment_data.sales_tmp using COPY (process_id=261)
2025-06-17 01:51:14,667:INFO:[Chunk-4] FINISHED loading 1994 records
2025-06-17 01:51:14,669:INFO:Finished loading file data/sales_transactions_261_encrypted.csv. Total rows loaded: 9984 (process_id=261)
2025-06-17 01:51:14,669:INFO:Performing alignment of temp table etl_assesment_data.sales_tmp to match target table etl_assesment_data.sales
2025-06-17 01:51:14,787:INFO:Column 'id' dropped from temp DataFrame before schema sync.
2025-06-17 01:51:14,862:INFO:Aligned and replaced temp table etl_assesment_data.sales_tmp before incremental insert.
2025-06-17 01:51:14,862:INFO:Performing incremental load from etl_assesment_data.sales_tmp to etl_assesment_data.sales for process_id 261
2025-06-17 01:51:26,778:INFO:Inserted 9984 new records into etl_assesment_data.sales
2025-06-17 01:51:26,782:INFO:ETL process completed successfully process_id=261. Total records loaded: 9984
2025-06-17 01:51:26,792:INFO:Moved file sales_transactions_261.csv to archive directory as sales_transactions_261_20250617_015126.csv
2025-06-17 01:51:26,793:INFO:Moved file sales_transactions_261_encrypted.csv to archive directory as sales_transactions_261_encrypted_20250617_015126.csv
