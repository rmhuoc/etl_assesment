2025-06-17 13:38:15,579:INFO:Starting ETL process...
2025-06-17 13:38:15,682:INFO:ETL process started with process_id=277
2025-06-17 13:38:15,867:INFO:Generated mock data saved to data/sales_transactions_277.csv with 10000 rows.
2025-06-17 13:38:15,923:INFO:Encryption key successfully loaded from 'config/secret.key'
2025-06-17 13:38:16,380:INFO:Encrypted CSV written to 'data/sales_transactions_277_encrypted.csv'
2025-06-17 13:38:16,385:INFO:Connection to database OK and verified.
2025-06-17 13:38:16,396:INFO:Processing file data/sales_transactions_277_encrypted.csv into etl_assesment_data.sales_tmp using chunks of size 2000
2025-06-17 13:38:16,396:INFO:Reading file data/sales_transactions_277_encrypted.csv in chunks of 2000 with max_workers=4
2025-06-17 13:38:16,397:INFO:=== ETL Configuration ===
2025-06-17 13:38:16,397:INFO:File path: data/sales_transactions_277_encrypted.csv
2025-06-17 13:38:16,397:INFO:Chunk size: 2000
2025-06-17 13:38:16,397:INFO:Max workers: 4
2025-06-17 13:38:16,397:INFO:Target schema: etl_assesment_data
2025-06-17 13:38:16,397:INFO:Target table: sales_tmp
2025-06-17 13:38:16,397:INFO:==========================
2025-06-17 13:38:16,474:INFO:Column 'process_id' is missing in DataFrame. Skipping adding it with None values here.
2025-06-17 13:38:16,501:INFO:[Chunk-0] STARTED with 2000 rows
2025-06-17 13:38:16,510:INFO:[Chunk-1] STARTED with 2000 rows
2025-06-17 13:38:16,520:INFO:[Chunk-2] STARTED with 2000 rows
2025-06-17 13:38:16,538:INFO:[Chunk-3] STARTED with 2000 rows
2025-06-17 13:38:18,507:INFO:[Chunk-0] Removed 1 rows with timestamp in the future
2025-06-17 13:38:18,518:INFO:[Chunk-1] Removed 4 rows with timestamp in the future
2025-06-17 13:38:18,527:INFO:Added process_id=277 to DataFrame before load.
2025-06-17 13:38:18,569:INFO:Added process_id=277 to DataFrame before load.
2025-06-17 13:38:18,569:INFO:[Chunk-3] Removed 4 rows with timestamp in the future
2025-06-17 13:38:18,571:INFO:[Chunk-2] Removed 1 rows with timestamp in the future
2025-06-17 13:38:18,617:INFO:Added process_id=277 to DataFrame before load.
2025-06-17 13:38:18,653:INFO:Added process_id=277 to DataFrame before load.
2025-06-17 13:38:18,690:INFO:Loaded 1999 records into etl_assesment_data.sales_tmp using COPY (process_id=277)
2025-06-17 13:38:18,691:INFO:[Chunk-0] FINISHED loading 1999 records
2025-06-17 13:38:18,691:INFO:[Chunk-4] STARTED with 2000 rows
2025-06-17 13:38:18,730:INFO:Loaded 1996 records into etl_assesment_data.sales_tmp using COPY (process_id=277)
2025-06-17 13:38:18,730:INFO:[Chunk-1] FINISHED loading 1996 records
2025-06-17 13:38:18,733:INFO:Loaded 1996 records into etl_assesment_data.sales_tmp using COPY (process_id=277)
2025-06-17 13:38:18,733:INFO:[Chunk-3] FINISHED loading 1996 records
2025-06-17 13:38:18,749:INFO:Loaded 1999 records into etl_assesment_data.sales_tmp using COPY (process_id=277)
2025-06-17 13:38:18,750:INFO:[Chunk-2] FINISHED loading 1999 records
2025-06-17 13:38:20,700:INFO:Added process_id=277 to DataFrame before load.
2025-06-17 13:38:20,792:INFO:Loaded 2000 records into etl_assesment_data.sales_tmp using COPY (process_id=277)
2025-06-17 13:38:20,792:INFO:[Chunk-4] FINISHED loading 2000 records
2025-06-17 13:38:20,793:INFO:Finished loading file data/sales_transactions_277_encrypted.csv. Total rows loaded: 9990 (process_id=277)
2025-06-17 13:38:20,794:INFO:Performing alignment of temp table etl_assesment_data.sales_tmp to match target table etl_assesment_data.sales
2025-06-17 13:38:20,944:INFO:Column 'id' dropped from temp DataFrame before schema sync.
2025-06-17 13:38:21,025:INFO:Aligned and replaced temp table etl_assesment_data.sales_tmp before incremental insert.
2025-06-17 13:38:21,025:INFO:Performing incremental load from etl_assesment_data.sales_tmp to etl_assesment_data.sales for process_id 277
2025-06-17 13:38:35,165:INFO:Inserted 9990 new records into etl_assesment_data.sales
2025-06-17 13:38:35,168:INFO:ETL process completed successfully process_id=277. Total records loaded: 9990
2025-06-17 13:38:35,174:INFO:Moved file sales_transactions_277.csv to archive directory as sales_transactions_277_20250617_133835.csv
2025-06-17 13:38:35,175:INFO:Moved file sales_transactions_277_encrypted.csv to archive directory as sales_transactions_277_encrypted_20250617_133835.csv
